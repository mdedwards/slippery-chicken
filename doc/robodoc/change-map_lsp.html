<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-type" content="text/html; charset=ISO-8859-1" />
<link rel="stylesheet" href="./robodoc.css" type="text/css" />
<script src="./robodoc.js"></script>
<title>change-map.lsp</title>
<!-- Source: ./../../src/change-map.lsp -->
<!-- Generated with ROBODoc Version 4.99.44 (Oct 31 2021) -->
</head>
<script type=text/javascript src=../head-foot.js></script>
<body>
<div id="content">
<script type="text/javascript">header("../");</script>

<div id="logo">
<a name="robo_top_of_doc"></a>
</div> <!-- logo -->
<div id="navigation">
<a class="menuitem" href="./toc_index.html#top">Table of Contents</a>
<a class="menuitem" href="./robo_sourcefiles.html#top">Sourcefiles</a>
<a class="menuitem" href="./roboindex.html#top">Index</a>
<a class="menuitem" href="./robo_parameters.html#top">Global Parameters</a>
<a class="menuitem" href="./robo_classes.html#top">Classes</a>
<a class="menuitem" href="./robo_functions.html#top">Functions</a>
<a class="menuitem" href="./robo_modules.html#top">Modules</a>
<a class="menuitem" href="./robo_methods.html#top">Methods</a>
</div> <!-- navigation -->


<a name="change2dmap2fcm2dget2ddata"></a>
<a name="robo65"></a><h2 class=robodoc>change-map/cm-get-data [ Methods ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo586">change-map</a> ] [ <a href="./robo_methods.html#robo_top_of_doc">Methods</a> ]</p>
<p class="item_name">DESCRIPTION</p>
<pre> Return the data for a specified <a href="./section_lsp.html#robo60">section</a> and <a href="./player_lsp.html#robo296">player</a> of a given <a href="#robo586">change-map</a>
 object. 

 NB: The &lt;<a href="./section_lsp.html#robo60">section</a>&gt; argument may require the ID of the <a href="./player_lsp.html#robo296">player</a> as well if
     used, for example, with the <a href="./instrument-change-map_lsp.html#robo67">instrument-change-map</a> subclass of this
     class .
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - A <a href="#robo586">change-map</a> object.
 - A simple key reference into the given <a href="#robo586">change-map</a> object or a list of
   references. NB: This reference may require a <a href="./player_lsp.html#robo296">player</a> ID if, for example,
   used with an <a href="./instrument-change-map_lsp.html#robo67">instrument-change-map</a> subclass of this class. 
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> - The ID of the sequence from which to return the <a href="#robo586">change-map</a> data.
 - An integer that is the bar number for which to return the <a href="#robo586">change-map</a>
   data. 
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> The <a href="#robo586">change-map</a> data stored at the specified location within the given
 <a href="#robo586">change-map</a>. 
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;;; An example using the <a href="./instrument-change-map_lsp.html#robo67">instrument-change-map</a> subclass of <a href="#robo586">change-map</a>

(let ((mini
       (<a href="./slippery-chicken_lsp.html#robo835">make-slippery-chicken</a>
        '+mini+
        :<a href="./ensemble_lsp.html#robo412">ensemble</a> '(((sax ((alto-sax tenor-sax) :midi-channel 1))))
        :<a href="./instrument-change-map_lsp.html#robo67">instrument-change-map</a> '((1 ((sax ((1 alto-sax) (3 tenor-sax)))))
                                 (2 ((sax ((2 alto-sax) (5 tenor-sax)))))
                                 (3 ((sax ((3 alto-sax) (4 tenor-sax))))))
        :<a href="./set-palette_lsp.html#robo314">set-palette</a> '((1 ((c2 d2 g2 a2 e3 fs3 b3 cs4 fs4 gs4 ds5 f5 bf5))))
        :<a href="./set-map_lsp.html#robo598">set-map</a> '((1 (1 1 1 1 1))
                   (2 (1 1 1 1 1))
                   (3 (1 1 1 1 1)))
        :<a href="./rthm-seq-palette_lsp.html#robo313">rthm-seq-palette</a> '((1 ((((4 4) h q e s s))
                                :<a href="./pitch-seq-palette_lsp.html#robo312">pitch-seq-palette</a> ((1 2 3 4 5)))))
        :<a href="./rthm-seq-map_lsp.html#robo597">rthm-seq-map</a> '((1 ((sax (1 1 1 1 1))))
                        (2 ((sax (1 1 1 1 1))))
                        (3 ((sax (1 1 1 1 1))))))))
  (<strong>cm-get-data</strong> (<a href="./instrument-change-map_lsp.html#robo67">instrument-change-map</a> mini) '(2 sax) 4))

=&gt; ALTO-SAX
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defmethod <strong>cm-get-data</strong> ((<a href="./cm_lsp.html#robo4">cm</a> change-map) <a href="./section_lsp.html#robo60">section</a> 
                        &amp;optional (sequence 1) (bar 1))
</pre>


<a name="change2dmap2ffind2dnearest"></a>
<a name="robo66"></a><h2 class=robodoc>change-map/find-nearest [ Methods ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo586">change-map</a> ] [ <a href="./robo_methods.html#robo_top_of_doc">Methods</a> ]</p>
<p class="item_name">DESCRIPTION</p>
<pre> Return the <a href="./utilities_lsp.html#robo972">nearest</a> <a href="./change-data_lsp.html#robo630">change-data</a> object to the specified <a href="./section_lsp.html#robo60">section</a> within the
 given <a href="#robo586">change-map</a>. NB: The <a href="./section_lsp.html#robo60">section</a> may require a <a href="./player_lsp.html#robo296">player</a> ID if used, for
 example, with an <a href="./instrument-change-map_lsp.html#robo67">instrument-change-map</a> subclass of <a href="#robo586">change-map</a>.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - A <a href="./section_lsp.html#robo60">section</a> indication, either as a single reference ID or a list of
   reference IDs into the given <a href="#robo586">change-map</a>.
 - A <a href="#robo586">change-map</a> object.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> Returns a <a href="./change-data_lsp.html#robo630">change-data</a> object.
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">(let ((mini
       (<a href="./slippery-chicken_lsp.html#robo835">make-slippery-chicken</a>
        '+mini+
        :<a href="./ensemble_lsp.html#robo412">ensemble</a> '(((sax ((alto-sax tenor-sax) :midi-channel 1))))
        :<a href="./instrument-change-map_lsp.html#robo67">instrument-change-map</a> '((1 ((sax ((1 alto-sax) (3 tenor-sax)))))
                                 (2 ((sax ((2 alto-sax) (5 tenor-sax)))))
                                 (3 ((sax ((3 alto-sax) (4 tenor-sax))))))
        :<a href="./set-palette_lsp.html#robo314">set-palette</a> '((1 ((c2 d2 g2 a2 e3 fs3 b3 cs4 fs4 gs4 ds5 f5 bf5))))
        :<a href="./set-map_lsp.html#robo598">set-map</a> '((1 (1 1 1 1 1))
                   (2 (1 1 1 1 1))
                   (3 (1 1 1 1 1)))
        :<a href="./rthm-seq-palette_lsp.html#robo313">rthm-seq-palette</a> '((1 ((((4 4) h q e s s))
                                :<a href="./pitch-seq-palette_lsp.html#robo312">pitch-seq-palette</a> ((1 2 3 4 5)))))
        :<a href="./rthm-seq-map_lsp.html#robo597">rthm-seq-map</a> '((1 ((sax (1 1 1 1 1))))
                        (2 ((sax (1 1 1 1 1))))
                        (3 ((sax (1 1 1 1 1))))))))
  (<strong>find-nearest</strong> '(4 sax) (<a href="./instrument-change-map_lsp.html#robo67">instrument-change-map</a> mini)))

=&gt; 
CHANGE-DATA: 
            previous-data: TENOR-SAX, 
            last-data: TENOR-SAX
SCLIST: <a href="./sclist_lsp.html#robo298">sclist</a>-length: 2, bounds-alert: T, copy: T
LINKED-NAMED-OBJECT: previous: (2 SAX), this: (3 SAX), next: NIL
NAMED-OBJECT: id: SAX, tag: NIL, 
data: ((3 1 ALTO-SAX) (4 1 TENOR-SAX))
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defmethod <strong>find-nearest</strong> (<a href="./section_lsp.html#robo60">section</a> (<a href="./cm_lsp.html#robo4">cm</a> change-map))
</pre>


<a name="sc2dmap2fchange2dmap"></a>
<a name="robo586"></a><h2 class=robodoc>sc-map/change-map [ Classes ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./sc-map_lsp.html#robo433">sc-map</a> ] [ <a href="./robo_classes.html#robo_top_of_doc">Classes</a> ]</p>
<p class="item_name">NAME</p>
<pre> <strong>change-map</strong>

 File:             <a href="#robo_top_of_doc">change-map.lsp</a>

 Class Hierarchy:  <a href="./named-object_lsp.html#robo628">named-object</a> -&gt; <a href="./linked-named-object_lsp.html#robo309">linked-named-object</a> -&gt; <a href="./sclist_lsp.html#robo298">sclist</a> -&gt; 
                   <a href="./circular-sclist_lsp.html#robo632">circular-sclist</a> -&gt; <a href="./assoc-list_lsp.html#robo113">assoc-list</a> -&gt; <a href="./recursive-assoc-list_lsp.html#robo47">recursive-assoc-list</a> -&gt;
                   <a href="./sc-map_lsp.html#robo433">sc-map</a> -&gt; <strong>change-map</strong>

 Version:          1.1.0

 Project:          slippery chicken (algorithmic composition)

 Purpose:          Implementation of the <strong>change-map</strong> class where, unlike
                   normal sc-maps (data is given for each sequence) gives
                   data sporadically when the parameter changes, for
                   instance <a href="./tempo_lsp.html#robo300">tempo</a>.

                   It is assumed that maps will be typed in the order in
                   which sections occur so that previous-data slots can be
                   kept up-to-date; also, unless all data will be given,
                   that the sections (but not <a href="./instrument_lsp.html#robo294">instrument</a> ids) will be in
                   integer sequential order so that <a href="./utilities_lsp.html#robo972">nearest</a> sections can be
                   returned when given a non-existent <a href="./section_lsp.html#robo60">section</a> reference.
                    
                   For example, the following <strong>change-map</strong> indicates <a href="./tempo_lsp.html#robo300">tempo</a> 
                   (though <a href="./tempo_lsp.html#robo300">tempo</a>-maps have their own class now).
                   It has sections within sections so that the <a href="./tempo_lsp.html#robo300">tempo</a> for
                   <a href="./section_lsp.html#robo60">section</a> '(1 2 3) can be defined, that is, <a href="./section_lsp.html#robo60">section</a> 1 has
                   subsections 1, 2, and 3 and subsection 2 has further
                   subsections 1, 2, and 3.  This can be nested to any
                   depth.  The <a href="./tempo_lsp.html#robo300">tempo</a> information itself is given in sublists
                   where (3 27) means that in the third sequence of the
                   <a href="./section_lsp.html#robo60">section</a>, the <a href="./tempo_lsp.html#robo300">tempo</a> is 27.  (3 2 27) means the 2nd bar of
                   the third sequence has <a href="./tempo_lsp.html#robo300">tempo</a> 27: when only two numbers
                   are in the list, bar 1 is assumed.  The trick is, that
                   this <a href="./tempo_lsp.html#robo300">tempo</a> then remains, as would be expected, until the
                   next <a href="./tempo_lsp.html#robo300">tempo</a> change is indicated, which means that
                   requesting the <a href="./tempo_lsp.html#robo300">tempo</a> of <a href="./section_lsp.html#robo60">section</a> (2 2 3) with any sequence
                   and bar in the map below would return 25, because that is
                   the last <a href="./tempo_lsp.html#robo300">tempo</a> given in <a href="./section_lsp.html#robo60">section</a> 1 and no <a href="./tempo_lsp.html#robo300">tempo</a> is defined
                   for <a href="./section_lsp.html#robo60">section</a> 2.

                   (setf x 
                     (make-<strong>change-map</strong>
                      'test nil
                      '((0 ((3 27) (9 3 45)))
                        (1 
                         ((1 ((1 21) (5 28) (8 35) (3 2 40) (3 1 54)))
                          (2 
                           ((1 ((1 23) (6 28) (18 35)))
                            (2 ((2 2 24) (7 28) (18 22)))
                            (3 ((3 34) (7 28) (18 42)))))
                          (3 ((1 22) (5 34) (10 5 25)))))
                        (4
                         ((1 ((1 21) (5 28) (8 36) (3 2 40) (3 1 55)))
                          (2 ((1 22) (5 34) (10 5 103)))))
                        (5 ((2 28) (6 3 45)))
                        (10
                         ((1 ((1 21) (5 28) (8 37) (3 2 40) (3 1 56)))
                          (2 ((1 22) (5 34) (10 5 27))))))))

                   You have to be careful with change-maps however as the
                   nesting is flexible and therefore ambiguous.  For
                   instance, in the following the bcl, tape1 etc. ids are
                   not subsections of <a href="./section_lsp.html#robo60">section</a> 1, rather these are the hint
                   pitches assigned to the <a href="./instruments_lsp.html#robo12">instruments</a> in <a href="./section_lsp.html#robo60">section</a> 1 (which
                   has no subsections).  This is where the last-ref-required
                   class slot comes in:  If this slot is t (this is the
                   second argument to make-change-map) then the last
                   reference in a call to <a href="#robo65">cm-get-data</a> is always respected,
                   i.e. not the last data given will be returned when the
                   <a href="./section_lsp.html#robo60">section</a> doesn't exist, rather the last data for this
                   reference.  E.g. In the following map, if
                   last-ref-required  were nil, then the call to
                   (<a href="#robo65">cm-get-data</a> x '(2 tape2) 1) would fail (because we can't
                   find <a href="./utilities_lsp.html#robo972">nearest</a> data when references aren't numbers), but
                   because it's t, we get the last data given for tape2 and
                   return cs5. 

                   (setf x                                         
                     (make-<strong>change-map</strong>                              
                         'hint-pitches t                           
                         '((1 ((bcl ((1 a4) (2 b4) (3 c5) (4 d6))) 
                               (tape1 ((1 a3) (2 ds2) (3 e4)))     
                               (tape2 ((1 a3) (2 ds2) (3 cs5)))    
                               (tape3 ((1 a3) (2 ds2) (3 eqf4))))) 
                           (2 ((bcl ((1 a4) (2 b4) (3 c5) (4 d6))) 
                               (tape1 ((1 a3) (2 ds2) (5 fs4)))))  
                           (3 ((bcl ((1 a4) (2 b4) (3 c5) (4 d6))) 
                               (tape1 ((1 a3) (2 ds2) (5 f4))))))))

 Author:           Michael Edwards: m@michael-edwards.org

 Creation date:    2nd April 2001

 $$ Last modified:  10:39:42 Thu Feb  1 2024 CET

 SVN ID: $Id$
</pre>

</div> <!-- content -->
<div id="footer">
<p>Generated from ./../../src/change-map.lsp with <a href="http://www.xs4all.nl/~rfsber/Robo/robodoc.html">ROBODoc</a> V4.99.44 on 2025-05-10 11:02:11</p>
</div> <!-- footer -->
</body>
</html>
