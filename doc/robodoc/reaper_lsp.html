<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-type" content="text/html; charset=ISO-8859-1" />
<link rel="stylesheet" href="./robodoc.css" type="text/css" />
<script src="./robodoc.js"></script>
<title>reaper.lsp</title>
<!-- Source: ./../../src/reaper.lsp -->
<!-- Generated with ROBODoc Version 4.99.44 (Oct 31 2021) -->
</head>
<script type=text/javascript src=../head-foot.js></script>
<body>
<div id="content">
<script type="text/javascript">header("../");</script>

<div id="logo">
<a name="robo_top_of_doc"></a>
</div> <!-- logo -->
<div id="navigation">
<a class="menuitem" href="./toc_index.html#top">Table of Contents</a>
<a class="menuitem" href="./robo_sourcefiles.html#top">Sourcefiles</a>
<a class="menuitem" href="./roboindex.html#top">Index</a>
<a class="menuitem" href="./robo_parameters.html#top">Global Parameters</a>
<a class="menuitem" href="./robo_classes.html#top">Classes</a>
<a class="menuitem" href="./robo_functions.html#top">Functions</a>
<a class="menuitem" href="./robo_modules.html#top">Modules</a>
<a class="menuitem" href="./robo_methods.html#top">Methods</a>
</div> <!-- navigation -->


<a name="reaper2finsert2denvelope"></a>
<a name="robo401"></a><h2 class=robodoc>reaper/insert-envelope [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">AUTHOR</p>
<pre> Leon Focker: leon@leonfocker.de
</pre>
<p class="item_name">DATE</p>
<pre> April 30th 2023.
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> get the string of a reaper file and rewrite it, so that a given envelope is
 inserted into the project in a given place.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - the string of the project file you want to edit
 - the reaper-envelope object that you want to insert into the reaper project
 - the number of the track, on which to insert the envelope (master is 0)
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> the edited string of the entire reaper file
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;;; insert the angle-env value of a <a href="./sndfile_lsp.html#robo301">sndfile</a> as an envelope on track 1 of 
;;; project.rpp and give it the duration of the <a href="./sndfile_lsp.html#robo301">sndfile</a>.
(let ((snd (<a href="./sndfile_lsp.html#robo891">make-sndfile</a> "/E/sound.wav" :angle-env '(0 0 1 1 2 .5))))
  (<strong>insert-envelope</strong> (<a href="./utilities_lsp.html#robo1008">read-file-as-string</a> "/E/project.rpp")
                   (<a href="#robo974">make-reaper-envelope</a> (angle-env snd)
                                         :env-type 'parmenv
                                         :parameter-slot 6)
                   1 0 (duration snd)))
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">#+cl-ppcre
(defun <strong>insert-envelope</strong> (string reaper-envelope track-nr)
</pre>


<a name="reaper2finsert2dplugin"></a>
<a name="robo402"></a><h2 class=robodoc>reaper/insert-plugin [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">AUTHOR</p>
<pre> Leon Focker: leon@leonfocker.de
</pre>
<p class="item_name">DATE</p>
<pre> April 30th 2023.
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> get the string of a reaper file and rewrite it, so that a given plugin is
 inserted into the project in a given place.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - the string of the project file you want to edit
 - the binary string of the plugin you want to insert. The easiest way of
 obtaining this is probably by copying it from a reaper file that you created
 manually (create a reaper project file and load the plugin, the open the
 file with a text editor and find and copy the string &lt;VST ..... &gt;.
 See "slippery-chicken/src/txt/iem-<a href="./sndfile_lsp.html#robo896">stereo</a>-encoder.txt" for an example).
 To use that plugin in write-spatial-<a href="#robo646">reaper-file</a> (of possibly others), <a href="./recursive-assoc-list_lsp.html#robo411">add</a>
 it to the 'plugins' slot in the definition of the <a href="#robo646">reaper-file</a> class.
 - the number of the track, on which to insert the plugin (master is 0)
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> - if the plugin is to be inserted before all others (t) or after all other
 plugins already on the track (nil)
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> the edited string of the entire reaper file
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;;; insert the blue ripple binaural ambisonics decoder on the master track of 
;;; project.rpp
(<strong>insert-plugin</strong> (<a href="./utilities_lsp.html#robo1008">read-file-as-string</a> "/E/project.rpp") *blue-ripple-decoder* 0 t)
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">#+cl-ppcre
(defun <strong>insert-plugin</strong> (string plugin-binary-string track-nr &amp;optional (pre nil))
</pre>


<a name="reaper2freaper2dlayer2dsounds"></a>
<a name="robo403"></a><h2 class=robodoc>reaper/reaper-layer-sounds [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">DATE</p>
<pre> October 1st 2022
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> Given a list of paths to sound files, create a reaper file that layers/mixes
 these together. We create as many mixes as possible given the number of
 tracks required, e.g. if there are 20 sound files and &lt;num-tracks&gt; is 4,
 then five mixes will be created, one after the other, with a gap of 10
 seconds by default. So the files are mixed together in the order of the
 first argument, with the longest file in the mix determining the overall
 duration and the shorter files beginning after a wait of &lt;indent&gt; multiplied
 by the difference <a href="./utilities_lsp.html#robo934">between</a> the longest and shorter files'
 durations. E.g. with a longest file duration of 60 seconds and a shorter
 file of 30 seconds, given :indent 0.5 the shorter file's start time would be
 15 seconds; if its duration was 20 seconds, the start time would be 20.

 In case sound files are passed in alphabetical order, e.g. by
 (get-sndfiles...), and assuming that it is undesireable that similarly-named
 sound files are placed one after the other, by default the function will
 <a href="./permutations_lsp.html#robo328">shuffle</a> the order of the mixes (i.e. the groups of 4 or whatever sound files
 per mix). NB the 4-groups are shuffled, not the files in the groups.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - a list of sound file paths (strings)
 - the number of tracks that should be layered/mixed
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments:
 :<a href="./tempo_lsp.html#robo302">tempo</a>. The BPM value that should be written to the reaper project, if
 desired. Default = 60.
 :max-fade. The maximum length in seconds of a fade-in or fade-out. If this
 is too long for any given sound file, the :mid-fade multiplied by the sound
 file duration will be used. Default = 15 seconds.
 :min-fade. The proportion of a sound file's duration that should be used if
 :max-fade can't be used for both fade-in and fade-out. This should generally
 be &lt; 0.5 but is not enforced. Default = 0.5.
 :<a href="#robo646">reaper-file</a>. The path of the <a href="#robo646">reaper-file</a> to be written. If this is NIL then
 no file is written and the <a href="#robo646">reaper-file</a> object is returned instead, with all
 mixes present. This could be used to <a href="./recursive-assoc-list_lsp.html#robo411">add</a> more tracks before writing the
 reaper file (see example below). Default = "/tmp/reaper-layer-sounds.rpp"
 :min-channels. The minimum number of a channels a reaper track should
 have. Usually this will be set to be the maximum number of channels any of
 the files on a single track have. But if you have a bunch of <a href="./sndfile_lsp.html#robo896">stereo</a> files
 you want to place on, say, a track which should become 5th order ambisonics,
 you can set this to 36. Note that all reaper tracks should have an even
 number of channels so however the channel number is achieved it will be
 rouned up to the <a href="./utilities_lsp.html#robo981">nearest</a> even number if necessary. Default = 2.
 :max-channels. This can be set to override the number of channels of any
 given sound file, should it have more channels than you want, for some
 reason. Default = 4.
 :gap. The gap in seconds <a href="./utilities_lsp.html#robo934">between</a> the end of the previous mix and the start
 of the next. Default = 10 seconds.
 :<a href="./permutations_lsp.html#robo328">shuffle</a>. Whether to <a href="./permutations_lsp.html#robo328">shuffle</a> the mixes before writing. See above for
 details. Default = T.
 :indent. How far in to start the shorter sounds, as a function of their
 duration difference to the longest file (see above). 0.5 would have them
 centered bang in the <a href="./utilities_lsp.html#robo976">middle</a>. By default the golden mean, 0.618034 (what
 else?) i.e. (/ (- (sqrt 5) 1) 2).
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> If :<a href="#robo646">reaper-file</a> is given, then the path will be returned after writing,
 otherwise a <a href="#robo646">reaper-file</a> object is returned.
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">(let ((overlaps (<a href="#robo404">reaper-overlap-sounds</a>
                 (<a href="./sndfile-palette_lsp.html#robo881">get-sndfiles</a> "/Volumes/slim500/snd/samples/ambience/rain") 
                 :<a href="#robo646">reaper-file</a> nil))
      (layers (<strong>reaper-layer-sounds</strong> (<a href="./sndfile-palette_lsp.html#robo881">get-sndfiles</a> "~/ic/projects/mete/clm") 4
                                   :<a href="#robo646">reaper-file</a> nil)))
  (<a href="./recursive-assoc-list_lsp.html#robo411">add</a> (<a href="./rthm-seq_lsp.html#robo563">get-first</a> (tracks overlaps)) (tracks layers))
  (<a href="#robo406">write-reaper-file</a> layers :min-channels 36
                     :file "~/ic/projects/mete/reaper/mete-clm-with-rain.rpp"))
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defun <strong>reaper-layer-sounds</strong> (sndfiles num-tracks
                            &amp;key (<a href="./tempo_lsp.html#robo302">tempo</a> 60)
                              (max-fade 15) ; seconds
                              (min-fade .4) ; proportion of duration
                              (<a href="#robo646">reaper-file</a> "/tmp/reaper-layer-sounds.rpp")
                              ;; e.g. if you want all tracks to be 26 channels
                              ;; despite the number of channels in the sound
                              ;; files set this here
                              (min-channels 2)
                              (max-channels 4)
                              ;; gap in seconds <a href="./utilities_lsp.html#robo934">between</a> groups
                              (gap 10)
                              ;; <a href="./permutations_lsp.html#robo328">shuffle</a> (fixed-seed) the subgroups so that the
                              ;; sound files are not simply processed by
                              ;; directory order?
                              (<a href="./permutations_lsp.html#robo328">shuffle</a> t)
                              (indent 0.618034))
</pre>


<a name="reaper2freaper2doverlap2dsounds"></a>
<a name="robo404"></a><h2 class=robodoc>reaper/reaper-overlap-sounds [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">DATE</p>
<pre> October 1st 2022.
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> Create a reaper file with one track that overlaps/cross-fades all the given
 sound files.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - a list of sound files paths (strings) to overlap
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments:
 
 :overlap. The proportion by which to overlap the sound files. Given that
 sound files can have any duration and be overlapped in any order, this
 proportion is applied to the shortest of any two sound files to be
 cross-faded. default = 0.5.
 :<a href="#robo646">reaper-file</a>. The path of the <a href="#robo646">reaper-file</a> to be written. If this is NIL then
 no file is written and the <a href="#robo646">reaper-file</a> object is returned instead, with all
 mixes present. This could be used to <a href="./recursive-assoc-list_lsp.html#robo411">add</a> more tracks before writing the
 reaper file (see example in reaper-layer-sounds). Default =
 "/tmp/reaper-layer-sounds.rpp"
 :min-channels. See <a href="#robo403">reaper-layer-sounds</a>. Default = 2.
 :max-channels. See <a href="#robo403">reaper-layer-sounds</a>. Default = 4.
 :track-name. The string used to name the track in reaper. Default =
 "overlaps"
 :<a href="./tempo_lsp.html#robo302">tempo</a>. The BPM value that should be written to the reaper project, if
 desired. Default = 60.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> If :<a href="#robo646">reaper-file</a> is given, then the path will be returned after writing,
 otherwise a <a href="#robo646">reaper-file</a> object is returned. See <a href="#robo403">reaper-layer-sounds</a> for an
 example.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defun <strong>reaper-overlap-sounds</strong> (sndfiles &amp;key (<a href="./tempo_lsp.html#robo302">tempo</a> 60) (min-channels 2)
                                         (max-channels 4) (overlap .5)
                                         (track-name "overlaps")
                                         (<a href="#robo646">reaper-file</a>
                                          "/tmp/reaper-layer-sounds.rpp"))
</pre>


<a name="reaper2fwrite2dreaper2dambisonics2dfile"></a>
<a name="robo405"></a><h2 class=robodoc>reaper/write-reaper-ambisonics-file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">AUTHOR</p>
<pre> Leon Focker: leon@leonfocker.de
</pre>
<p class="item_name">DATE</p>
<pre> April 30th 2023.
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> Create a reaper file that contains all the data to spatialize sndfiles using
 the ambisonics method. For more information on the spatialization data, see
 #'<a href="./sndfile_lsp.html#robo891">make-sndfile</a>
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - a list of <a href="./sndfile_lsp.html#robo301">sndfile</a> objects: their angle-env and elevation-env arguments
 will be used for spatialization.
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments:

 :file. The path to the file that shall be generated.
 :start-times. A list of start times for each soundfile on each track in
 seconds. If the list is shorter than the number of sndfiles, it is looped.
 Default = '(0) - this means all files start at 0.
 :sample-rate. The sample-rate that should be written to the reaper project.
 Default = 48000.
 :ambi-order. Should be an integer <a href="./utilities_lsp.html#robo934">between</a> 1 and 8, this determines the
 number of channel for each track.
 :<a href="./tempo_lsp.html#robo302">tempo</a>. The BPM value that should be written to the reaper project, if
 desired. Default = 60.
 :init-volume. Volume multipliers for all faders.
 -0dB would be 1, Default = -12dB.
 :encoder. The key to find the binary data for the plugin that will be
 inserted into all tracks except the master track in the 'plugins' slot
 of the <a href="#robo646">reaper-file</a> class.
 Default: :iem-<a href="./sndfile_lsp.html#robo896">stereo</a>-encoder
 :decoder. The key to find the binary data for the plugin that will be
 inserted on the master track in the 'plugins' slot of the <a href="#robo646">reaper-file</a> class.
 Default: :blue-ripple-decoder
 :angle-parameter-slot. The automation slot that the angle-env will controll.
 This should be changed when other plugins are used than the defaults.
 Default = 6, because the IEM <a href="./sndfile_lsp.html#robo896">stereo</a> encoders 6th automation slot is the
 angle-argument. If this is a list of numbers, the first element will be used
 for the first angle-env of the <a href="./sndfile_lsp.html#robo301">sndfile</a> and the second for the second env
 etc. (when more than one is given for each <a href="./sndfile_lsp.html#robo301">sndfile</a>).
 :elevation-parameter-slot. The automation slot that the elevation-env will
 controll. This should be changed when other plugins are used than the
 defaults. Default = 7, because the IEM <a href="./sndfile_lsp.html#robo896">stereo</a> encoders 7th automation slot
 is the elevation-argument. If this is a list of numbers, the first element
 will be used for the first elevation-env of the <a href="./sndfile_lsp.html#robo301">sndfile</a> and the second for
 the second env etc. (when more than one is given for each <a href="./sndfile_lsp.html#robo301">sndfile</a>).
 :angle-offset. An offset for the rotation of the scene, where 1 = 360°.
 Default is 0.5, so that the angle 0 is the front for the iem plugins.
 :envs-use-start-times. If nil, all envelopes start at the minimal
 start-time. If t, the envelopes use the start time of the respective
 <a href="./sndfile_lsp.html#robo301">sndfile</a>.
 :envs-use-end-times. If nil, all envelopes end when every <a href="./sndfile_lsp.html#robo301">sndfile</a> hast
 stopped. If t, end when the respective <a href="./sndfile_lsp.html#robo301">sndfile</a> stopps.
 :envs-duration. If nil, the behavior of envs-use-end-times applies.
 If a number, every automation envelope gets this duration -
 envs-use-end-times will be ignored in this case.
 envs-only. If t, don't write a file or insert any plugins, just re-write the
 envelopes. This is usefull if you <a href="./wolfram_lsp.html#robo1038">generate</a> a file with this function and 
 edited the project file by adding more tracks etc. (These should be added
 after the already existing ones). Then you could edit the envelopes of the
 sndfiles and set envs-only to t. This way, the file will stay the same
 except for the envelopes.
 :envs-visible. t or nil, wheter all envelopes will be visible (opened) in the
 <a href="#robo646">reaper-file</a>.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> path to the reaper file that was generated.
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;;; make three soundfiles into <a href="./sndfile_lsp.html#robo301">sndfile</a> objects and spatialize them, while 
;;; returning their paths in windows format.
(set-sc-config 'reaper-files-for-windows t)
(<strong>write-reaper-ambisonics-file</strong>
 `(,(<a href="./sndfile_lsp.html#robo891">make-sndfile</a> "/E/pads.wav"
                          :angle-env '(0 0  .5 .5  .8 4  1 3.5)
                          :elevation-env '(0 0  .6 .25  2 .5))
    ,(<a href="./sndfile_lsp.html#robo891">make-sndfile</a> "/E/synths.wav"
                          :angle-env '(0 0  .5 .5  .8 8  1 3.25)
                          :elevation-env '(0 0.5  1 .25))
    ,(<a href="./sndfile_lsp.html#robo891">make-sndfile</a> "/E/drums.wav"
                          :angle-env '(0 .5  .5 1  .8 8.5  1 3.75)
                          :elevation-env '(0 0.5  1 .25)))
 :file "/E/spatial.rpp"
 :ambi-order 3
 :envs-use-start-times t
 :envs-use-end-times t)


;;; spatialize one <a href="./sndfile_lsp.html#robo301">sndfile</a> with two channels, that are opposite and circling
;;; each other:
(<strong>write-reaper-ambisonics-file</strong> 
 `(,(<a href="./sndfile_lsp.html#robo891">make-sndfile</a> "/E/code/feedback/intro.wav"
                  :angle-env '((0 0  .5 .5  .8 4  1 3.5)
                               (0 .5  .5 1  .8 4.5  1 4))
                  :elevation-env '(0 0  .6 .25  2 .5)))
 :file "/E/code/test.rpp"
 :encoder :iem-multi-encoder
 :angle-parameter-slot '(7 12)
 :elevation-parameter-slot '(8 13))
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">#+cl-ppcre
(defun <strong>write-reaper-ambisonics-file</strong> (list-of-sndfiles
                                     &amp;key file
                                       (start-times '(0))
                                       (sample-rate 48000)
                                       (ambi-order 3)
                                       (<a href="./tempo_lsp.html#robo302">tempo</a> 60)
                                       (init-volume .2511)
                                       (encoder :iem-<a href="./sndfile_lsp.html#robo896">stereo</a>-encoder)
                                       (decoder :blue-ripple-decoder)
                                       (angle-parameter-slot 6)
                                       (elevation-parameter-slot 7)
                                       (angle-offset 0.5)
                                       (envs-use-start-times t)
                                       (envs-use-end-times t)
                                       envs-duration
                                       envs-only
                                       (envs-visible t))
</pre>


<a name="reaper2fwrite2dreaper2dfile"></a>
<a name="robo406"></a><h2 class=robodoc>reaper/write-reaper-file [ Methods ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./robo_methods.html#robo_top_of_doc">Methods</a> ]</p>
<p class="item_name">DESCRIPTION</p>
<pre> Write a reaper file from the reaper-items in the data slot.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - a <a href="#robo646">reaper-file</a> object
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments: 
 - :file. The path of the reaper file to write. Default will be the id slot
   of the <a href="#robo646">reaper-file</a> object + .rpp, placed in the default-directory of
   <a href="./slippery-chicken_lsp.html#robo632">slippery-chicken</a> (itself /tmp by default).
 - :markers. These are either a simple list of times (in seconds) or a
   mixture containing sublists such as (marker-number time-in-secs
   label-string colour), or just the first two or three of those. See the
   write-reaper-marker method for details. Default = NIL.
 - :min-channels (default 2) and :max-channels (default 4). These are the
   minimum and maximum channel counts of the reaper-tracks which are usually
   dependent upon or influence the number of channels reflected in the sound
   files' playback. A sound file could have any number of channels of course
   and usually we'd use the maximum number of channels a track's sound files
   have to set the channels slot, but here we can <a href="./tl-set_lsp.html#robo919">limit</a> these to something
   reasonable (or e.g. force 4-channel tracks even though all sound files are
   <a href="./sndfile_lsp.html#robo896">stereo</a>).
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> The patch to the generated reaper file.
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;;; one simple way of algorithmically generating a reaper file:
(let* ((<a href="./tempo_lsp.html#robo302">tempo</a> 240)
       (items
         (make-reaper-items1
          (<a href="./sndfile-palette_lsp.html#robo881">get-sndfiles</a>
           (concatenate 'string
                        cl-user::+slippery-chicken-home-dir+
                        "tests/test-sndfiles-dir-2"))
          '(e (w) (q) q (h) (e) e. (q.) q (w) e (w) e.)
           <a href="./tempo_lsp.html#robo302">tempo</a>
          :input-start '(0 .1 .2)
          :play-rate '(1 1.02 1 .98 1.01 1 1.02)
          :preserve-<a href="./pitch_lsp.html#robo297">pitch</a> t))
       ;; NB the <a href="./tempo_lsp.html#robo302">tempo</a> of the reaper file is independent of the items
       (rf (make-<a href="#robo646">reaper-file</a> 'reaper-test items :<a href="./tempo_lsp.html#robo302">tempo</a> <a href="./tempo_lsp.html#robo302">tempo</a>)))
  (<strong>write-reaper-file</strong> rf))

;;; or to write a reaper file with markers only, at times given in seconds
(<strong>write-reaper-file</strong> (make-<a href="#robo646">reaper-file</a> 'test nil) :markers '(1 2 3.5 7))

;;; mixed marker data starting with simple times
(<strong>write-reaper-file</strong> (make-<a href="#robo646">reaper-file</a> 'test nil)
  :markers '(1 2 3.5 7 (49 8.021 "nice label") ; number 49, time 8.021, named 
             (562 9.1 "better label" blue))) ; sim. but with a recognised colour
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defmethod <strong>write-reaper-file</strong> ((rf reaper-file)
                              &amp;key file markers
                              (min-channels 2) (max-channels 4))
</pre>


<a name="reaper2fwrite2dreaper2dsad2dfile"></a>
<a name="robo407"></a><h2 class=robodoc>reaper/write-reaper-sad-file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">AUTHOR</p>
<pre> Leon Focker: leon@leonfocker.de
</pre>
<p class="item_name">DATE</p>
<pre> May 22nd 2023.
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> Create a reaper file that contains all the data to spatialize sndfiles using
 the spatial audio designer plugins. For this, the angle and elevation
 arguments of the sndfiles wil be converted to the cartesian coordinate
 system.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - a list of <a href="./sndfile_lsp.html#robo301">sndfile</a> objects: their angle-env and elevation-env arguments
 will be used for spatialization.
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments:

 :file. The path to the file that shall be generated.
 :start-times. A list of start times for each soundfile on each track in
 seconds. If the list is shorter than the number of sndfiles, it is looped.
 Default = '(0) - this means all files start at 0.
 :sample-rate. The sample-rate that should be written to the reaper project.
 Default = 48000.
 :nr-of-master-channels. = How many channels the master bus will have. The
 number of channels for each track is determined by the number of channels
 the soundfiles on each track has, but is at least 2 and not more than 8.
 :<a href="./tempo_lsp.html#robo302">tempo</a>. The BPM value that should be written to the reaper project, if
 desired. Default = 60.
 :init-volume. Volume multpiliers for all faders.
 -0dB would be 1, Default = -12dB.
 :angle-offset. An offset for the rotation of the scene, where 1 = 360°.
 Default is 0, so that the angle 0 is the front.
 :env-conversion-srate. This number is the minimum amount of times per second
 that an additional point is calculated and converted from polar to cartesian
 coordinates. Default = 4, which means that at least every .25 seconds there
 will be a breakpoint. If this number is too low (&lt; 1), the conversion from
 polar to cartesian won't represent the original envelope very well.
 :envs-use-start-times. If nil, all envelopes start at the minimal
 start-time. If t, the envelopes use the start time of the respective
 <a href="./sndfile_lsp.html#robo301">sndfile</a>.
 :envs-use-end-times. If nil, all envelopes end when every <a href="./sndfile_lsp.html#robo301">sndfile</a> hast
 stopped. If t, end when the respective <a href="./sndfile_lsp.html#robo301">sndfile</a> stopps.
 :envs-duration. If nil, the behavior of envs-use-end-times applies.
 If a number, every automation envelope gets this duration -
 envs-use-end-times will be ignored in this case.
 envs-only. If t, don't write a file or insert any plugins, just re-write the
 envelopes. This is usefull if you <a href="./wolfram_lsp.html#robo1038">generate</a> a file with this function and 
 edited the project file by adding more tracks etc. (These should be added
 after the already existing ones). Then you could edit the envelopes of the
 sndfiles and set envs-only to t. This way, the file will stay the same
 except for the envelopes.
 :envs-visible. t or nil, wheter all envelopes will be visible (opened) in the
 <a href="#robo646">reaper-file</a>.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> path to the reaper file that was generated.
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;;; make three soundfiles into <a href="./sndfile_lsp.html#robo301">sndfile</a> objects and spatialize them, while 
;;; returning their paths in windows format.
(set-sc-config 'reaper-files-for-windows t)
(<strong>write-reaper-sad-file</strong>
 `(,(<a href="./sndfile_lsp.html#robo891">make-sndfile</a> "/E/pads.wav"
                          :angle-env '(0 0  .5 .5  .8 4  1 3.5)
                          :elevation-env '(0 0  .6 .25  2 .5))
    ,(<a href="./sndfile_lsp.html#robo891">make-sndfile</a> "/E/synths.wav"
                          :angle-env '(0 0  .5 .5  .8 8  1 3.25)
                          :elevation-env '(0 0.5  1 .25))
    ,(<a href="./sndfile_lsp.html#robo891">make-sndfile</a> "/E/drums.wav"
                          :angle-env '(0 .5  .5 1  .8 8.5  1 3.75)
                          :elevation-env '(0 0.5  1 .25)))
 :file "/E/spatial.rpp"
 :envs-use-start-times t
 :envs-use-end-times t)

;;; spatialize one <a href="./sndfile_lsp.html#robo301">sndfile</a> with two channels, that are opposite and circling
;;; each other:
(<strong>write-reaper-sad-file</strong> 
 `(,(<a href="./sndfile_lsp.html#robo891">make-sndfile</a> "/E/code/feedback/intro.wav"
                  :angle-env '((0 0  .5 .5  .8 4  1 3.5)
                               (0 .5  .5 1  .8 4.5  1 4))
                  :elevation-env '(0 0  .6 .25  2 .5)))
 :file "/E/code/test.rpp")
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">#+cl-ppcre
(defun <strong>write-reaper-sad-file</strong> (list-of-sndfiles
                              &amp;key file
                                (start-times '(0))
                                (sample-rate 48000)
                                (nr-of-master-channels 2)
                                (<a href="./tempo_lsp.html#robo302">tempo</a> 60)
                                (init-volume .2511)
                                (angle-offset 0)
                                (env-conversion-srate 4)
                                (envs-use-start-times t)
                                (envs-use-end-times t)
                                envs-duration
                                envs-only
                                (envs-visible t))
</pre>


<a name="sclist2freaper2dfile"></a>
<a name="robo646"></a><h2 class=robodoc>sclist/reaper-file [ Classes ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./sclist_lsp.html#robo300">sclist</a> ] [ <a href="./robo_classes.html#robo_top_of_doc">Classes</a> ]</p>


<a name="sclist2freaper2dtrack"></a>
<a name="robo647"></a><h2 class=robodoc>sclist/reaper-track [ Classes ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./sclist_lsp.html#robo300">sclist</a> ] [ <a href="./robo_classes.html#robo_top_of_doc">Classes</a> ]</p>


<a name="sndfile2freaper2ditem"></a>
<a name="robo892"></a><h2 class=robodoc>sndfile/reaper-item [ Classes ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./sndfile_lsp.html#robo301">sndfile</a> ] [ <a href="./robo_classes.html#robo_top_of_doc">Classes</a> ]</p>
<p class="item_name">NAME</p>
<pre> reaper

 File:             <a href="#robo_top_of_doc">reaper.lsp</a>            

 Class Hierarchy:  <a href="./named-object_lsp.html#robo631">named-object</a> -&gt; <a href="./linked-named-object_lsp.html#robo311">linked-named-object</a> -&gt; <a href="./sndfile_lsp.html#robo301">sndfile</a> -&gt;
                   <strong>reaper-item</strong>
 Class Hierarchy:  <a href="./named-object_lsp.html#robo631">named-object</a> -&gt; <a href="./linked-named-object_lsp.html#robo311">linked-named-object</a> -&gt; <a href="./sclist_lsp.html#robo300">sclist</a> -&gt;
                   <a href="#robo647">reaper-track</a>
 Class Hierarchy:  <a href="./named-object_lsp.html#robo631">named-object</a> -&gt; <a href="./linked-named-object_lsp.html#robo311">linked-named-object</a> -&gt; <a href="./sclist_lsp.html#robo300">sclist</a> -&gt;
                   <a href="#robo646">reaper-file</a>

 Version:          1.1.0

 Project:          slippery chicken (algorithmic composition)

 Purpose:          Class and routine definition for the generation of partial
                   and/or complete reaper files from rhythms, soundfiles.
                   NB Because this class can write reaper files that include
                   video as well as sound files (and we need to distinguish
                   <a href="./utilities_lsp.html#robo934">between</a> the two), the ffprobe command is needed here.

 Author:           Michael Edwards: m@michael-edwards.org

 Creation date:    January 21st 2021

 $$ Last modified:  12:37:33 Mon Feb 24 2025 CET

 SVN ID: $Id: <a href="./sclist_lsp.html#robo_top_of_doc">sclist.lsp</a> 963 2010-04-08 20:58:32Z medward2 $
</pre>


<a name="utilities2fmake2dreaper2denvelope"></a>
<a name="robo974"></a><h2 class=robodoc>utilities/make-reaper-envelope [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./utilities_lsp.html#robo21">utilities</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">AUTHOR</p>
<pre> Leon Focker: leon@leonfocker.de
</pre>
<p class="item_name">DATE</p>
<pre> April 30th 2023.
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> make a reaper-envelope object.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - a list which represents an envelope, meaning it consists of x and y values
 For example: '(0 0  50 1  100 .5)
 Usually the first x value would be 0, all following x values should be
 ascending numbers. The length of the envelope (meaning the value of the last
 x value isn't important here)
 Note that if you use <a href="./wolfram_lsp.html#robo1038">generate</a>-auotmation-data on the resulting
 reaper-envelope object, y values will range from 0 to 1. The env list can
 obviously have y values greater than that, but those will be reduced
 modulo 1 (see env-mod). An envelope like '(0 0 1 3) would then result in
 something like this:
 '(0 0 1/3 .9999999 (+ 1/3 .001) 0 2/3 .9999999 (+ 2/3 .001) 0 1.0 .9999999)
 :parameter-min and :parameter-max are applied after that operation.
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments:
 :env-type. A symbol. Wheter this envelope controls a plugin ('parmenv) or
 another parameter of a track. Valid options are:
 volume volume-pre-fx trim-volume pan pan-pre-fx width width-pre-fx mute <a href="./tempo_lsp.html#robo302">tempo</a>
 aux-volume aux-pan aux-mute parmenv...
 Any symbol that isn't recognized will create a 'parmenv.
 :start-time. the time in seconds at which the first point of the envelope
 will be
 :end-time. the time in seconds at which the last point of the envelope will
 be
 :parameter-slot. A positive integer. When env-type is 'parmenv, this
 determines which parameter of the plugin the envelope controls. Open reaper
 and the plugin and then count the automatable parameters to find out which
 one you want. For example, the angle-parameter for the iem <a href="./sndfile_lsp.html#robo896">stereo</a> encoder is
 the 6th.
 :parameter-min. The minimm value the envelope will have in reaper. Usually
 it is 0 but for example for panorama it could be -1. This is less important.
 :parameter-max. The maximum value the envelope will have in reaper. Usually
 it is 1 but for example for volume it could be 2. This is less important.
 :is-visible. t or nil, wheter the envelope will be visible (opened) in the
 <a href="#robo646">reaper-file</a>.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> the envelope-object
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defun <strong>make-reaper-envelope</strong> (env &amp;key (env-type 'parmenv)
                                   start-time
                                   end-time
                                   parameter-slot
                                   parameter-min
                                   parameter-max
                                   (is-visible t))
</pre>


<a name="utilities2fmake2dreaper2ditems4"></a>
<a name="robo975"></a><h2 class=robodoc>utilities/make-reaper-items4 [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./utilities_lsp.html#robo21">utilities</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">AUTHOR</p>
<pre> Leon Focker: leon@leonfocker.de
</pre>
<p class="item_name">DATE</p>
<pre> April 30th 2023.
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> make-reaper-items but every <a href="./sndfile_lsp.html#robo301">sndfile</a> gets its own track and start-times are
 given individually. 
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - a list of sndfiles
 - a list of start-times for the sndfiles within the reaper project. If this
 list is shorter than sndfiles it is looped.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> a list of reaper-items
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defun <strong>make-reaper-items4</strong> (sndfiles &amp;optional (start-times '(0)))
</pre>


<a name="utilities2fpdivide2dreaper2dmarkers"></a>
<a name="robo994"></a><h2 class=robodoc>utilities/pdivide-reaper-markers [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./utilities_lsp.html#robo21">utilities</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">DESCRIPTION</p>
<pre> Write to standard out (terminal/interpreter) marker data for a reaper file
 generated from calls to the <a href="./utilities_lsp.html#robo993">pdivide</a> function.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> Takes the same arguments as the <a href="./utilities_lsp.html#robo993">pdivide</a> function
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> T
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defun <strong>pdivide-reaper-markers</strong> (&amp;rest args)
</pre>


<a name="utilities2fpexpand2dreaper2dmarkers"></a>
<a name="robo998"></a><h2 class=robodoc>utilities/pexpand-reaper-markers [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./utilities_lsp.html#robo21">utilities</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">DATE</p>
<pre> September 4th 2015, Edinburgh
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> Using the <a href="./utilities_lsp.html#robo996">pexpand</a> function, we write marker information in a format which
 can be read by the Reaper (version 4/5+) DAW software. Though we can think
 of the outputs of <a href="./utilities_lsp.html#robo996">pexpand</a> to be in beats, seconds, bars, or any arbitrary
 <a href="./rthm-seq-palette_lsp.html#robo553">scale</a>, the timings of Reaper markers are in seconds, hence the need here
 for an initial <a href="./tempo_lsp.html#robo302">tempo</a>. In other words, we treat the output of <a href="./utilities_lsp.html#robo996">pexpand</a> to be
 beat counts; if you would prefer to interpret these as bars, simply divide
 the <a href="./tempo_lsp.html#robo302">tempo</a> by the number of beats per bar. If there are to be <a href="./tempo_lsp.html#robo302">tempo</a> changes
 in the mix/<a href="./piece_lsp.html#robo58">piece</a> Reaper itself will update the markers' positions when the
 new <a href="./tempo_lsp.html#robo302">tempo</a> is inserted in the project window--this is fine when you are
 thinking in beats/bars but beware of changing <a href="./tempo_lsp.html#robo302">tempo</a> in Reaper if you are
 thinking of markers with fixed timings (seconds).

 Copy the output of this into the Reaper file verbatim (no enclosing &lt; &gt;
 marks) before the &lt;PROJBAY tag.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - the <a href="./tempo_lsp.html#robo302">tempo</a> in BPM
 - the number of generations: see the <a href="./utilities_lsp.html#robo996">pexpand</a> function
 - (&amp;rest) the proportions: see the <a href="./utilities_lsp.html#robo996">pexpand</a> function
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> Always T
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">(<strong>pexpand-reaper-markers</strong> 144 2 6 3 5 4)
-&gt;
  MARKER 1 7.5 "level 4" 0 0 1
  MARKER 2 15.0 "level 4" 0 0 1
  MARKER 3 22.5 "level 4" 0 0 1
  MARKER 4 30.0 "level 4" 0 0 1
  MARKER 5 37.5 "level 4" 0 0 1
...
  MARKER 108 810.0 "level 1" 0 0 1
  MARKER 109 817.5 "level 4" 0 0 1
  MARKER 110 825.0 "level 4" 0 0 1
  MARKER 111 832.5 "level 4" 0 0 1
  MARKER 112 840.0 "level 4" 0 0 1
  MARKER 113 847.5 "level 4" 0 0 1
  MARKER 114 855.0 "level 3" 0 0 1
...
  MARKER 319 2392.5 "level 4" 0 0 1
  MARKER 320 2400.0 "level 3" 0 0 1
  MARKER 321 2407.5 "level 4" 0 0 1
  MARKER 322 2415.0 "level 4" 0 0 1
  MARKER 323 2422.5 "level 4" 0 0 1


Here's where I pasted the data into the .RPP Reaper file:

  &lt;TEMPOENVEX
    ACT 0
    VIS 1 0 1
    LANEHEIGHT 0 0
    ARM 0
    DEFSHAPE 1 -1 -1
  &gt;
  MARKER 1 7.5 "level 4" 0 0 1
  MARKER 2 15 "level 4" 0 0 1
  MARKER 3 22.5 "level 4" 0 0 1
  MARKER 4 30 "level 4" 0 0 1
...
  MARKER 320 2400 "level 3" 0 0 1
  MARKER 321 2407.5 "level 4" 0 0 1
  MARKER 322 2415 "level 4" 0 0 1
  MARKER 323 2422.5 "level 4" 0 0 1
  &lt;PROJBAY
  &gt;
  &lt;TRACK {EBF9837F-BE25-9542-B720-A1862C0DF380}
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defun <strong>pexpand-reaper-markers</strong> (<a href="./tempo_lsp.html#robo302">tempo</a> generations &amp;rest proportions)
</pre>

</div> <!-- content -->
<div id="footer">
<p>Generated from ./../../src/reaper.lsp with <a href="http://www.xs4all.nl/~rfsber/Robo/robodoc.html">ROBODoc</a> V4.99.44 on 2025-08-13 11:15:10</p>
</div> <!-- footer -->
</body>
</html>
