<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-type" content="text/html; charset=ISO-8859-1" />
<link rel="stylesheet" href="./robodoc.css" type="text/css" />
<script src="./robodoc.js"></script>
<title>tl-set.lsp</title>
<!-- Source: ./../../src/tl-set.lsp -->
<!-- Generated with ROBODoc Version 4.99.44 (Oct 31 2021) -->
</head>
<script type=text/javascript src=../head-foot.js></script>
<body>
<div id="content">
<script type="text/javascript">header("../");</script>

<div id="logo">
<a name="robo_top_of_doc"></a>
</div> <!-- logo -->
<div id="navigation">
<a class="menuitem" href="./toc_index.html#top">Table of Contents</a>
<a class="menuitem" href="./robo_sourcefiles.html#top">Sourcefiles</a>
<a class="menuitem" href="./roboindex.html#top">Index</a>
<a class="menuitem" href="./robo_parameters.html#top">Global Parameters</a>
<a class="menuitem" href="./robo_classes.html#top">Classes</a>
<a class="menuitem" href="./robo_functions.html#top">Functions</a>
<a class="menuitem" href="./robo_modules.html#top">Modules</a>
<a class="menuitem" href="./robo_methods.html#top">Methods</a>
</div> <!-- navigation -->


<a name="sc2dset2ftl2dset"></a>
<a name="robo627"></a><h2 class=robodoc>sc-set/tl-set [ Classes ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./sc-set_lsp.html#robo648">sc-set</a> ] [ <a href="./robo_classes.html#robo_top_of_doc">Classes</a> ]</p>
<p class="item_name">NAME</p>
<pre> <strong>tl-set</strong>

 File:             <a href="#robo_top_of_doc">tl-set.lsp</a>

 Class Hierarchy:  <a href="./named-object_lsp.html#robo628">named-object</a> -&gt; <a href="./linked-named-object_lsp.html#robo309">linked-named-object</a> -&gt; <a href="./sclist_lsp.html#robo298">sclist</a> -&gt; <a href="./chord_lsp.html#robo631">chord</a> -&gt;
                   <a href="./sc-set_lsp.html#robo648">sc-set</a> -&gt; <strong>tl-set</strong>

 Version:          1.1.0

 Project:          slippery chicken (algorithmic composition)

 Purpose:          Implementation of the <strong>tl-set</strong> class that extends
                   set to incorporate transposition and limiting to
                   certain <a href="./pitch_lsp.html#robo295">pitch</a> ranges.  NB As of yet, once a set is
                   transposed or limited, it can't be retransposed from its
                   original pitches, only from the current set, i.e these
                   methods are destructive!

 Author:           Michael Edwards: m@michael-edwards.org

 Creation date:    13th August 2001

 $$ Last modified:  17:39:50 Wed Feb  7 2024 CET

 SVN ID: $Id$
</pre>


<a name="tl2dset2fharp2dsalzedo2dto2dtl2dset"></a>
<a name="robo909"></a><h2 class=robodoc>tl-set/harp-salzedo-to-tl-set [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo627">tl-set</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">AUTHOR</p>
<pre> Ruben Philipp &lt;me@rubenphilipp.com&gt;

 CREATED
 2023-11-22, Essen
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> This function creates a <a href="#robo627">tl-set</a> from a list of harp pedalling indications
 (similar to those introduced by Salzedo). Thus, the resulting <a href="#robo627">tl-set</a>
 represents all producible pitches on a concert harp within a given range
 (defined by the :<a href="./event_lsp.html#robo202">lowest</a> and :<a href="./event_lsp.html#robo197">highest</a> slots). 
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> A 7-item list with the position of the pedals, where -1 indicates lowering
 the respective note a half step, 0 means no alteration, 1 means raising the
 note a half. The order of notes reflects the pedal structure of the concert
 harp (i.e. D C B E F G A). Thus, '(0 1 0 0 0 -1 0) leads to the following
 alteration: C# D E F Gb A B
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword-arguments:
 - :id. The id of the sc-st to be generated. 
 - :<a href="./event_lsp.html#robo202">lowest</a>. This is the <a href="./event_lsp.html#robo202">lowest</a> note to be contained in the set.
   Default = 'b0
   <a href="./instruments_lsp.html#robo252">+slippery-chicken-standard-instrument-palette+</a>.
 - :<a href="./event_lsp.html#robo197">highest</a>. This is the <a href="./event_lsp.html#robo197">highest</a> note to be contained in the set.
   Default = 'gs7
 - :<a href="#robo910">limit</a>-lower. A note-name symbol or a <a href="./pitch_lsp.html#robo295">pitch</a> object to indicate the
   <a href="./event_lsp.html#robo202">lowest</a> possible <a href="./pitch_lsp.html#robo295">pitch</a> in the <a href="#robo627">tl-set</a> object to be created (cf.
   make-tl-set). Default = The value of :<a href="./event_lsp.html#robo202">lowest</a>-written 'harp in
   <a href="./instruments_lsp.html#robo252">+slippery-chicken-standard-instrument-palette+</a>.
 - :<a href="#robo910">limit</a>-upper. A note-name symbol or a <a href="./pitch_lsp.html#robo295">pitch</a> object to indicate the
   <a href="./event_lsp.html#robo197">highest</a> possible <a href="./pitch_lsp.html#robo295">pitch</a> in the <a href="#robo627">tl-set</a> object to be created (cf.
   make-tl-set). Default = The value of :<a href="./event_lsp.html#robo197">highest</a>-written 'harp in
   <a href="./instruments_lsp.html#robo252">+slippery-chicken-standard-instrument-palette+</a>.
 - :subsets. Inherited from <a href="#robo913">make-tl-set</a>.
 - :related-sets. Inherited from <a href="#robo913">make-tl-set</a>.
 - :auto-sort. Inherited from <a href="#robo913">make-tl-set</a>. Default = T.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> An <a href="#robo627">tl-set</a> generated from the given data. 
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">(<strong>harp-salzedo-to-tl-set</strong> '(0 0 -1 0 0 1 -1))

=&gt;
TL-SET: transposition: 0
        <a href="#robo910">limit</a>-upper: NIL
        <a href="#robo910">limit</a>-lower: NIL
SC-SET: auto-sort: T, rm-dups: T, warn-dups: T used-notes: 
RECURSIVE-ASSOC-LIST: recurse-simple-data: T
                      num-data: 0
                      linked: NIL
                      full-ref: NIL
ASSOC-LIST: warn-not-found T
CIRCULAR-SCLIST: current 0
SCLIST: <a href="./sclist_lsp.html#robo298">sclist</a>-length: 0, bounds-alert: T, copy: T
LINKED-NAMED-OBJECT: previous: NIL, 
                     this: NIL, 
                     next: NIL
NAMED-OBJECT: id: USED-NOTES, tag: NIL, 
data: NIL
**************
, 

**** N.B. All pitches printed as symbols only, internally they are all 
<a href="./pitch_lsp.html#robo295">pitch</a>-objects.


    subsets: 
    related-sets: 
CHORD: auto-sort: T, marks: NIL, micro-tone: NIL, micro-tonality: 0.0
<a href="./sndfile_lsp.html#robo880">centroid</a>: NIL, dissonance: NIL
SCLIST: <a href="./sclist_lsp.html#robo298">sclist</a>-length: 48, bounds-alert: T, copy: T
LINKED-NAMED-OBJECT: previous: NIL, 
                     this: NIL, 
                     next: NIL
NAMED-OBJECT: id: NIL, tag: NIL, 
data: (C1 D1 E1 F1 Gs1 Af1 Bf1 C2 D2 E2 F2 Gs2 Af2 Bf2 C3 D3 E3 F3 Gs3 Af3 Bf3
       C4 D4 E4 F4 Gs4 Af4 Bf4 C5 D5 E5 F5 Gs5 Af5 Bf5 C6 D6 E6 F6 Gs6 Af6 Bf6
       C7 D7 E7 F7 Gs7 Af7)
**************
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defun <strong>harp-salzedo-to-tl-set</strong> (salzedo
                               &amp;key
                                 id
                                 (<a href="./event_lsp.html#robo202">lowest</a> 'b0)
                                 (<a href="./event_lsp.html#robo197">highest</a> 'gs7)
                                 (<a href="#robo910">limit</a>-lower (<a href="./event_lsp.html#robo202">lowest</a>-written
                                               (<a href="./instruments_lsp.html#robo257">get-standard-ins</a> 'harp)))
                                 (<a href="#robo910">limit</a>-upper (<a href="./event_lsp.html#robo197">highest</a>-written
                                               (<a href="./instruments_lsp.html#robo257">get-standard-ins</a> 'harp)))
                                 subsets
                                 related-sets
                                 (auto-sort t))
</pre>


<a name="tl2dset2flimit"></a>
<a name="robo910"></a><h2 class=robodoc>tl-set/limit [ Methods ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo627">tl-set</a> ] [ <a href="./robo_methods.html#robo_top_of_doc">Methods</a> ]</p>
<p class="item_name">DESCRIPTION</p>
<pre> Remove <a href="./pitch_lsp.html#robo295">pitch</a> objects from a given <a href="#robo627">tl-set</a> whose <a href="./pitch_lsp.html#robo295">pitch</a> content is higher or
 lower than the pitches specified. Any <a href="./pitch_lsp.html#robo295">pitch</a> objects whose <a href="./pitch_lsp.html#robo295">pitch</a> content is
 equal to the <strong>limit</strong> pitches specified will be retained.

 NB: C0 and B10 are the <a href="./event_lsp.html#robo197">highest</a> and <a href="./event_lsp.html#robo202">lowest</a> possible pitches of the
     quarter-tone <a href="./afu_lsp.html#robo32">scale</a> defined in <a href="./afu_lsp.html#robo32">scale</a>.lsp (16.35 and 31608.55 Hz
     respectively).

 NB: The keyword arguments for which the lower and upper <a href="./sclist_lsp.html#robo637">limits</a> are to be
     specified are optional arguments, but are required in order for any
     effect to be had.

 NB: Whether a <a href="./pitch_lsp.html#robo295">pitch</a> is higher or lower than the specified pitches is
     determined by their frequencies. If a <a href="./pitch_lsp.html#robo295">pitch</a> happens to be <a href="./event_lsp.html#robo209">microtonal</a> it
     could be that the <a href="./utilities_lsp.html#robo972">nearest</a> <a href="./pitch_lsp.html#robo295">pitch</a> symbol is an approximation, i.e. not
     quite the same as the frequency, so limiting might appear to be working
     incorrectly.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - The <a href="#robo627">tl-set</a> object.
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments:
 - :upper. A note-name symbol that is the upper <strong>limit</strong> for the limiting
   process.
 - :lower. A note-name symbol that is the lower <strong>limit</strong> for the limiting
   process.
 - :do-related-sets. T or NIL to indicate whether the RELATED-SETS slot of
   the given <a href="#robo627">tl-set</a> object is to be transposed as well or left unhandled. T
   = <a href="#robo915">transpose</a>. Default = NIL.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> A <a href="#robo627">tl-set</a> object.
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;;; By default the method does not <a href="#robo915">transpose</a> the pitches of the RELATED-SETS
;;; slot 
(let ((mtls (<a href="#robo913">make-tl-set</a> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
                         :subsets '((fl (df5 f5 af5))
                                    (vla (e3 g3 b3)))
                         :related-sets '((missing (fs2 b5))))))
  (<strong>limit</strong> mtls :upper 'df5 :lower 'c3))

=&gt; 
TL-SET: transposition: 0
        <strong>limit</strong>-upper: 
PITCH: frequency: 554.365, midi-note: 73, midi-channel: 0 
[...]
    subsets: 
FL: (DF5)
VLA: (E3 G3 B3)
    related-sets: 
MISSING: (FS2 B5)
SCLIST: <a href="./sclist_lsp.html#robo298">sclist</a>-length: 14, bounds-alert: T, copy: T
LINKED-NAMED-OBJECT: previous: NIL, this: NIL, next: NIL
NAMED-OBJECT: id: NIL, tag: NIL, 
data: (C3 E3 G3 B3 D4 GF4 BF4 DF5)

;; Setting the :do-related-sets argument to T results in any RELATED-SETS <a href="./pitch_lsp.html#robo295">pitch</a>
;; content being transposed as well
(let ((mtls (<a href="#robo913">make-tl-set</a> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
                         :subsets '((fl (df5 f5 af5))
                                    (vla (e3 g3 b3)))
                         :related-sets '((missing (fs2 b5))))))
  (<strong>limit</strong> mtls :upper 'c6 :lower 'c3 :do-related-sets t))

=&gt;
[...]
    subsets: 
FL: (DF5 F5 AF5)
VLA: (E3 G3 B3)
    related-sets: 
MISSING: (B5)
SCLIST: <a href="./sclist_lsp.html#robo298">sclist</a>-length: 14, bounds-alert: T, copy: T
LINKED-NAMED-OBJECT: previous: NIL, this: NIL, next: NIL
NAMED-OBJECT: id: NIL, tag: NIL, 
data: (C3 E3 G3 B3 D4 GF4 BF4 DF5 F5 AF5 C6)
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defmethod <strong>limit</strong> ((tls tl-set) &amp;key upper lower do-related-sets)
</pre>


<a name="tl2dset2flimit2dfor2dinstrument"></a>
<a name="robo911"></a><h2 class=robodoc>tl-set/limit-for-instrument [ Methods ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo627">tl-set</a> ] [ <a href="./robo_methods.html#robo_top_of_doc">Methods</a> ]</p>
<p class="item_name">DESCRIPTION</p>
<pre> Remove any <a href="./pitch_lsp.html#robo295">pitch</a> objects from the given <a href="#robo627">tl-set</a> object which are outside of
 the range of the specified <a href="./instrument_lsp.html#robo294">instrument</a> object. 

 The <a href="./pitch_lsp.html#robo295">pitch</a> objects returned after that operation can then be reduced again
 by applying further <a href="./sclist_lsp.html#robo637">limits</a> specified by the :upper and :lower keyword
 arguments.  

 NB: This method returns a list of <a href="./pitch_lsp.html#robo295">pitch</a> objects, not a <a href="#robo627">tl-set</a> object,
     though it does destructively alter the data of the given <a href="#robo627">tl-set</a> object
     accordingly. 

 NB: This method will return NIL if the <a href="./pitch_lsp.html#robo295">pitch</a> objects of the given <a href="#robo627">tl-set</a>
     object are <a href="./event_lsp.html#robo209">microtonal</a> while the given <a href="./instrument_lsp.html#robo294">instrument</a> object is set to be a
     non-<a href="./event_lsp.html#robo209">microtonal</a> <a href="./instrument_lsp.html#robo294">instrument</a> (see example).

 NB: Whether a <a href="./pitch_lsp.html#robo295">pitch</a> is higher or lower than the specified pitches is
     determined by their frequencies. If a <a href="./pitch_lsp.html#robo295">pitch</a> happens to be <a href="./event_lsp.html#robo209">microtonal</a> it
     could be that the <a href="./utilities_lsp.html#robo972">nearest</a> <a href="./pitch_lsp.html#robo295">pitch</a> symbol is an approximation, i.e. not
     quite the same as the frequency, so limiting might appear to be working
     incorrectly.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - A <a href="#robo627">tl-set</a> object.
 - An <a href="./instrument_lsp.html#robo294">instrument</a> object.
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments:
 - :upper. A <a href="./pitch_lsp.html#robo295">pitch</a> object or note-name symbol that is the uppermost possible
   <a href="./pitch_lsp.html#robo295">pitch</a> (inclusive) of the <a href="./pitch_lsp.html#robo295">pitch</a> objects returned, as a further limitation
   after the range of the <a href="./instrument_lsp.html#robo294">instrument</a> object has been applied.
 - :lower. A <a href="./pitch_lsp.html#robo295">pitch</a> object or note-name symbol that is the lowermost possible
   <a href="./pitch_lsp.html#robo295">pitch</a> (inclusive) of the <a href="./pitch_lsp.html#robo295">pitch</a> objects returned, as a further limitation
   after the range of the <a href="./instrument_lsp.html#robo294">instrument</a> object has been applied.
 - :do-related-sets. T or NIL to indicate whether to apply the specified
   range restrictions to the RELATED-SETS slot of the given <a href="#robo627">tl-set</a> object as
   well. NB: These will be modified within the original <a href="#robo627">tl-set</a> object but
   not returned as part of the resulting list. T = apply to RELATED-SETS as
   well. Default = NIL.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> A list of <a href="./pitch_lsp.html#robo295">pitch</a> objects.
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;;; Returns a list of <a href="./pitch_lsp.html#robo295">pitch</a> objects, limited only by the range of the given
;;; <a href="./instrument_lsp.html#robo294">instrument</a> object by default
(let ((mtls (<a href="#robo913">make-tl-set</a> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
                         :related-sets '((other-notes (b4 e5 fs5 c6)))))
      (mi (<a href="./instrument_lsp.html#robo245">make-instrument</a> 'flute 
                           :staff-name "Flute" :staff-short-name "Fl."
                           :<a href="./event_lsp.html#robo202">lowest</a>-written 'c4 :<a href="./event_lsp.html#robo197">highest</a>-written 'd7 
                           :starting-clef 'treble :midi-program 74 :chords nil
                           :microtones t :missing-notes '(cqs4 dqf4))))
  (<strong>limit-for-instrument</strong> mtls mi))

=&gt;
(
PITCH: frequency: 293.665, midi-note: 62, midi-channel: 0
[...] 
data: D4
[...] 
PITCH: frequency: 369.994, midi-note: 66, midi-channel: 0 
[...] 
data: GF4
[...] 
PITCH: frequency: 466.164, midi-note: 70, midi-channel: 0 
[...] 
data: BF4
[...] 
PITCH: frequency: 554.365, midi-note: 73, midi-channel: 0 
[...] 
data: DF5
[...] 
PITCH: frequency: 698.456, midi-note: 77, midi-channel: 0 
[...] 
data: F5
[...] 
PITCH: frequency: 830.609, midi-note: 80, midi-channel: 0 
[...] 
data: AF5
[...] 
PITCH: frequency: 1046.502, midi-note: 84, midi-channel: 0 
[...] 
data: C6
)

;;; Further restrict the pitches returned by setting values for the :upper and
;;; :lower keyword arguments and print the new <a href="./pitch_lsp.html#robo295">pitch</a> content of the given
;;; <a href="#robo627">tl-set</a> object to see the destructive modification
(let ((mtls (<a href="#robo913">make-tl-set</a> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
                         :related-sets '((other-notes (b4 e5 fs5 c6)))))
      (mi (<a href="./instrument_lsp.html#robo245">make-instrument</a> 'flute 
                           :staff-name "Flute" :staff-short-name "Fl."
                           :<a href="./event_lsp.html#robo202">lowest</a>-written 'c4 :<a href="./event_lsp.html#robo197">highest</a>-written 'd7 
                           :starting-clef 'treble :midi-program 74 :chords nil
                           :microtones t :missing-notes '(cqs4 dqf4))))
  (<strong>limit-for-instrument</strong> mtls mi :upper 'b5 :lower 'c5)
  (<a href="./sc-set_lsp.html#robo618">pitch-symbols</a> mtls))

=&gt; (DF5 F5 AF5)

;;; By default the RELATED-SETS slot of the given <a href="#robo627">tl-set</a> object is not affected 
(let ((mtls (<a href="#robo913">make-tl-set</a> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
                         :related-sets '((other-notes (b4 e5 fs5 c6)))))
      (mi (<a href="./instrument_lsp.html#robo245">make-instrument</a> 'flute 
                           :staff-name "Flute" :staff-short-name "Fl."
                           :<a href="./event_lsp.html#robo202">lowest</a>-written 'c4 :<a href="./event_lsp.html#robo197">highest</a>-written 'd7 
                           :starting-clef 'treble :midi-program 74 :chords nil
                           :microtones t :missing-notes '(cqs4 dqf4))))
  (<strong>limit-for-instrument</strong> mtls mi :upper 'b5 :lower 'c5)
  (loop for nobj in (data (related-sets mtls)) 
     collect (loop for p in (data nobj) 
                collect (data p))))

=&gt; ((B4 E5 FS5 C6))


;;; Setting the :do-related-sets argument to T will cause the method to be
;;; applied to the RELATED-SETS slot as well.
(let ((mtls (<a href="#robo913">make-tl-set</a> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
                         :related-sets '((other-notes (b4 e5 fs5 c6)))))
      (mi (<a href="./instrument_lsp.html#robo245">make-instrument</a> 'flute 
                           :staff-name "Flute" :staff-short-name "Fl."
                           :<a href="./event_lsp.html#robo202">lowest</a>-written 'c4 :<a href="./event_lsp.html#robo197">highest</a>-written 'd7 
                           :starting-clef 'treble :midi-program 74 :chords nil
                           :microtones t :missing-notes '(cqs4 dqf4))))
  (<strong>limit-for-instrument</strong> mtls mi :upper 'b5 :lower 'c5 :do-related-sets t)
  (print (<a href="./sc-set_lsp.html#robo618">pitch-symbols</a> mtls))
  (print (loop for nobj in (data (related-sets mtls)) 
            collect (loop for p in (data nobj) 
                       collect (data p)))))

=&gt;
(DF5 F5 AF5) 
((E5 FS5))

;;; The method will return NIL if a set of only <a href="./event_lsp.html#robo209">microtonal</a> pitches (which
;;; e.g. <a href="./set-palette_lsp.html#robo677">ring-mod</a> might return) is given in combination with an <a href="./instrument_lsp.html#robo294">instrument</a>
;;; object which is not microtone-capable (such as the 'piano object of the
;;; <a href="./instruments_lsp.html#robo252">+slippery-chicken-standard-instrument-palette+</a> 
(let ((mtls (<a href="#robo913">make-tl-set</a> '(dqs2 fqs2 aqf2 gqs3 bqf3 gqf4 bqf4 dqf5 fqs5)))
      (pno (<a href="./recursive-assoc-list_lsp.html#robo414">get-data</a> 'piano 
                     +slippery-chicken-standard-<a href="./instrument_lsp.html#robo294">instrument</a>-<a href="./palette_lsp.html#robo424">palette</a>+)))
  (<strong>limit-for-instrument</strong> mtls pno :lower 'e5 :upper 'd6))

=&gt; NIL
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defmethod <strong>limit-for-instrument</strong> ((tls tl-set) (ins <a href="./instrument_lsp.html#robo294">instrument</a>)
                                 &amp;key upper lower do-related-sets)
</pre>


<a name="tl2dset2flimit2dshift2doctave"></a>
<a name="robo912"></a><h2 class=robodoc>tl-set/limit-shift-octave [ Methods ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo627">tl-set</a> ] [ <a href="./robo_methods.html#robo_top_of_doc">Methods</a> ]</p>
<p class="item_name">DATE</p>
<pre> August 18th 2015, Edinburgh
</pre>
<p class="item_name">DESCRIPTION</p>
<pre> Like the <a href="#robo910">limit</a> method, we restrict pitches in the set to be within
 specified <a href="./sclist_lsp.html#robo637">limits</a>, but instead of removing pitches we shift them to octaves
 within the <a href="./sclist_lsp.html#robo637">limits</a>. Rather than just putting the outlying pitches up or down
 and octave or two, we put them into the least-used octave of the set so as
 to balance <a href="./pitch_lsp.html#robo295">pitch</a> spread.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - the <a href="#robo627">tl-set</a> object
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments:
 - :upper. A note-name symbol that is the upper <a href="#robo910">limit</a> for the limiting
   process.
 - :lower. A note-name symbol that is the lower <a href="#robo910">limit</a> for the limiting
   process.
 - :do-related-sets. T or NIL to indicate whether the RELATED-SETS slot of
   the given <a href="#robo627">tl-set</a> object is to be transposed as well or left unhandled. T
   = <a href="#robo915">transpose</a>. Default = NIL.
 - :<a href="./event_lsp.html#robo197">highest</a>-wins. T or NIL to indicate whether in the case of a <a href="./slippery-chicken-edit_lsp.html#robo778">tie</a> when
   searching for the least used octave in a set, the <a href="./event_lsp.html#robo197">highest</a> octave will be
   used to move notes into. Default = T.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> The <a href="#robo627">tl-set</a> object.
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;;; the C2 will be shifted to C5 as the 5th octave is the least used in the
;;; original set. The DS5 will be shifted down to DS2 as once we've shifted the
;;; C2, the second octave is now the least used, plus it's within range.
(<a href="./rthm-seq-bar_lsp.html#robo505">get-pitch-symbols</a>
 (<strong>limit-shift-octave</strong> (<a href="#robo913">make-tl-set</a> '(c2 e2 cs3 f3 g3 d4 a4 ds5))
                     :upper 'c5 :lower 'd2))
--&gt; (DS2 E2 CS3 F3 G3 D4 A4 C5)
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defmethod <strong>limit-shift-octave</strong> ((tls tl-set)
                               &amp;key upper lower (<a href="./event_lsp.html#robo197">highest</a>-wins t)
                                 do-related-sets)
</pre>


<a name="tl2dset2fmake2dtl2dset"></a>
<a name="robo913"></a><h2 class=robodoc>tl-set/make-tl-set [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo627">tl-set</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">DESCRIPTION</p>
<pre> Create a <a href="#robo627">tl-set</a> object, which extends the <a href="./sc-set_lsp.html#robo648">sc-set</a> class by incorporating
 transposition and limiting to certain <a href="./pitch_lsp.html#robo295">pitch</a> ranges. 
 
 NB: As of yet, once a set is transposed or limited, it can't be
     re-transposed from its original pitches, only from the current set; i.e
     these methods are destructive!
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - A list of note-name symbols that is to be the set (<a href="./pitch_lsp.html#robo295">pitch</a>-set) for the
   given <a href="#robo627">tl-set</a> object.
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments:
 - :id. A symbol that is to be the ID of the given <a href="#robo627">tl-set</a> object.
 - :subsets. An <a href="./assoc-list_lsp.html#robo113">assoc-list</a> of key/data pairs, in which the data is a list of
   note-name symbols that are a subset of the main set. One use for this
   keyword argument might be to create subsets that particular <a href="./instruments_lsp.html#robo12">instruments</a>
   can play; these would then be selected in the <a href="./chord_lsp.html#robo631">chord</a>-function passed to
   the <a href="./instrument_lsp.html#robo294">instrument</a> object.
 - :related-sets. An <a href="./assoc-list_lsp.html#robo113">assoc-list</a> of key/data pairs, similar to :subsets, only
   that the pitches given here do not have to be part of the main set. This
   can be used, for example, for pitches missing from the main set.
 - :<a href="#robo910">limit</a>-upper. A note-name symbol or a <a href="./pitch_lsp.html#robo295">pitch</a> object to indicate the
   <a href="./event_lsp.html#robo197">highest</a> possible <a href="./pitch_lsp.html#robo295">pitch</a> in the <a href="#robo627">tl-set</a> object to be created.
 - :<a href="#robo910">limit</a>-lower.  A note-name symbol or a <a href="./pitch_lsp.html#robo295">pitch</a> object to indicate the
   <a href="./event_lsp.html#robo202">lowest</a> possible <a href="./pitch_lsp.html#robo295">pitch</a> in the <a href="#robo627">tl-set</a> object to be created.
 - :transposition. A number that is the number of <a href="./utilities_lsp.html#robo1010">semitones</a> by which the
   pitches of the new <a href="#robo627">tl-set</a> are to be transposed when the object is
   created. Default = 0.
 - :auto-sort. T or NIL to indicate whether the specified pitches (note-name
   symbols) are to be automatically sorted from <a href="./event_lsp.html#robo202">lowest</a> to <a href="./event_lsp.html#robo197">highest</a>. T =
   sort. Default = T.
 - :tag. The tag (symbol, string) to be attached to the object; from the
   <a href="./named-object_lsp.html#robo628">named-object</a> base class. Default = NIL.
 - :warn-dups. To or NIL to indicate whether a warning should be issued if
   duplicate pitches are found. Default = T.
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> A <a href="#robo627">tl-set</a> object.
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;; Simple usage with default values for keyword arguments
(<strong>make-tl-set</strong> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6))

=&gt; 
TL-SET: transposition: 0
        <a href="#robo910">limit</a>-upper: NIL
        <a href="#robo910">limit</a>-lower: NIL
SC-SET: auto-sort: T, used-notes: 
RECURSIVE-ASSOC-LIST: recurse-simple-data: T
                      num-data: 0
                      linked: NIL
                      full-ref: NIL
ASSOC-LIST: warn-not-found T
CIRCULAR-SCLIST: current 0
SCLIST: <a href="./sclist_lsp.html#robo298">sclist</a>-length: 0, bounds-alert: T, copy: T
LINKED-NAMED-OBJECT: previous: NIL, this: NIL, next: NIL
NAMED-OBJECT: id: USED-NOTES, tag: NIL, 
data: NIL

N.B. All pitches printed as symbols only, internally they are all 
<a href="./pitch_lsp.html#robo295">pitch</a>-objects.

    subsets: 
    related-sets: 
SCLIST: <a href="./sclist_lsp.html#robo298">sclist</a>-length: 14, bounds-alert: T, copy: T
LINKED-NAMED-OBJECT: previous: NIL, this: NIL, next: NIL
NAMED-OBJECT: id: NIL, tag: NIL, 
data: (D2 F2 A2 C3 E3 G3 B3 D4 GF4 BF4 DF5 F5 AF5 C6)

;; Adding subsets and related-sets
(<strong>make-tl-set</strong> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
             :subsets '((fl (df5 f5 af5))
                        (vla (e3 g3 b3)))
             :related-sets '((missing (fs2 b5))))
=&gt; 
TL-SET: transposition: 0
[...]
    subsets: 
FL: (DF5 F5 AF5)
VLA: (E3 G3 B3)
    related-sets: 
MISSING: (FS2 B5)
SCLIST: <a href="./sclist_lsp.html#robo298">sclist</a>-length: 14, bounds-alert: T, copy: T
LINKED-NAMED-OBJECT: previous: NIL, this: NIL, next: NIL
NAMED-OBJECT: id: NIL, tag: NIL, 
data: (D2 F2 A2 C3 E3 G3 B3 D4 GF4 BF4 DF5 F5 AF5 C6)

;; Limiting the <a href="./pitch_lsp.html#robo295">pitch</a> range of the <a href="#robo627">tl-set</a> object, once using a note-name
;; symbol and once using a <a href="./pitch_lsp.html#robo295">pitch</a> object
(<strong>make-tl-set</strong> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
             :<a href="#robo910">limit</a>-upper 'g5
             :<a href="#robo910">limit</a>-lower (<a href="./pitch_lsp.html#robo348">make-pitch</a> 'd3))

=&gt; 
TL-SET: transposition: 0
        <a href="#robo910">limit</a>-upper: 
PITCH: frequency: 783.991, midi-note: 79, midi-channel: 0 
[...]
        <a href="#robo910">limit</a>-lower: 
PITCH: frequency: 146.832, midi-note: 50, midi-channel: 0 
[...]
data: (E3 G3 B3 D4 GF4 BF4 DF5 F5)

;; Applying a transposition by <a href="./utilities_lsp.html#robo1010">semitones</a>
(<strong>make-tl-set</strong> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
             :transposition 3)

=&gt;
TL-SET: transposition: 3
[...]
data: (F2 AF2 C3 EF3 G3 BF3 D4 F4 A4 CS5 E5 AF5 B5 EF6)
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defun <strong>make-tl-set</strong> (set &amp;key id tag subsets related-sets
                          <a href="#robo910">limit</a>-upper <a href="#robo910">limit</a>-lower
                          (rm-dups t) (warn-dups t)
                          (transposition 0)
                          (auto-sort t))
</pre>


<a name="tl2dset2fstack"></a>
<a name="robo914"></a><h2 class=robodoc>tl-set/stack [ Methods ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo627">tl-set</a> ] [ <a href="./robo_methods.html#robo_top_of_doc">Methods</a> ]</p>
<p class="item_name">DESCRIPTION</p>
<pre> Extend the <a href="./pitch_lsp.html#robo295">pitch</a> content of a given <a href="./sc-set_lsp.html#robo648">sc-set</a> object by adding new <a href="./pitch_lsp.html#robo295">pitch</a>
 objects which have the same interval structure as the original set. 

 NB: See documentation for the <strong>stack</strong> method in the <a href="./sc-set_lsp.html#robo648">sc-set</a> class for usage. 
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defmethod <strong>stack</strong> ((tls tl-set) num-stacks &amp;key id by-freq respell)
</pre>


<a name="tl2dset2ftranspose"></a>
<a name="robo915"></a><h2 class=robodoc>tl-set/transpose [ Methods ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo627">tl-set</a> ] [ <a href="./robo_methods.html#robo_top_of_doc">Methods</a> ]</p>
<p class="item_name">DESCRIPTION</p>
<pre> Transpose the pitches of a given <a href="#robo627">tl-set</a> by a specified number of
 <a href="./utilities_lsp.html#robo1010">semitones</a>. 

 The contents of the SUBSETS slot are automatically transposed as well, but
 the RELATED-SETS slot is left untransposed by default. An optional argument
 allows for RELATED-SETS slot to be transposed as well.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre> - A <a href="#robo627">tl-set</a> object.
 - A positive or negative integer that is the number of <a href="./utilities_lsp.html#robo1010">semitones</a> by which
   the <a href="./pitch_lsp.html#robo295">pitch</a> content of the given <a href="#robo627">tl-set</a> object is to be transposed.
</pre>
<p class="item_name">OPTIONAL ARGUMENTS</p>
<pre> keyword arguments:
 - :do-related-sets. T or NIL to indicate whether to <strong>transpose</strong> any contents
   of the RELATED-SETS slot as well. T = <strong>transpose</strong>.  Default = NIL.
 (- additional &lt;ignore&gt; arguments are for internal use only)
</pre>
<p class="item_name">RETURN VALUE</p>
<pre> The <a href="#robo627">tl-set</a> object.
</pre>
<p class="item_name">EXAMPLE</p>
<pre class="source">;; By default the RELATED-SETS are left untransposed
(let ((mtls (<a href="#robo913">make-tl-set</a> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
                         :subsets '((fl (df5 f5 af5))
                                    (vla (e3 g3 b3)))
                         :related-sets '((missing (fs2 b5))))))
  (<strong>transpose</strong> mtls 3))

=&gt; 
TL-SET: transposition: 3
        <a href="#robo910">limit</a>-upper: NIL
        <a href="#robo910">limit</a>-lower: NIL
SC-SET: auto-sort: T, used-notes: 
[...]
    subsets: 
FL: (E5 AF5 B5)
VLA: (G3 BF3 D4)
    related-sets: 
MISSING: (FS2 B5)
SCLIST: <a href="./sclist_lsp.html#robo298">sclist</a>-length: 14, bounds-alert: T, copy: T
LINKED-NAMED-OBJECT: previous: NIL, this: NIL, next: NIL
pNAMED-OBJECT: id: NIL, tag: NIL, 
data: (F2 AF2 C3 EF3 G3 BF3 D4 F4 A4 CS5 E5 AF5 B5 EF6)

;; Set the &lt;do-related-sets&gt; argument to T for the RELATED-SETS contents to be
;; transposed as well
(let ((mtls (<a href="#robo913">make-tl-set</a> '(d2 f2 a2 c3 e3 g3 b3 d4 gf4 bf4 df5 f5 af5 c6)
                         :subsets '((fl (df5 f5 af5))
                                    (vla (e3 g3 b3)))
                         :related-sets '((missing (fs2 b5))))))
  (<strong>transpose</strong> mtls 3 :do-related-sets t))

=&gt; 
TL-SET: transposition: 3
        <a href="#robo910">limit</a>-upper: NIL
        <a href="#robo910">limit</a>-lower: NIL
SC-SET: auto-sort: T, used-notes: 
[...]
    subsets: 
FL: (E5 AF5 B5)
VLA: (G3 BF3 D4)
    related-sets: 
MISSING: (A2 D6)
SCLIST: <a href="./sclist_lsp.html#robo298">sclist</a>-length: 14, bounds-alert: T, copy: T
LINKED-NAMED-OBJECT: previous: NIL, this: NIL, next: NIL
NAMED-OBJECT: id: NIL, tag: NIL, 
data: (F2 AF2 C3 EF3 G3 BF3 D4 F4 A4 CS5 E5 AF5 B5 EF6)
</pre>
<p class="item_name">SYNOPSIS</p>
<pre class="source">(defmethod <strong>transpose</strong> :before ((tls tl-set) <a href="./utilities_lsp.html#robo1010">semitones</a> 
                              &amp;key destructively do-related-sets
                                ;; MDE Wed Aug 22 09:43:29 2018
                                <a href="./event_lsp.html#robo202">lowest</a> <a href="./event_lsp.html#robo197">highest</a>)
</pre>

</div> <!-- content -->
<div id="footer">
<p>Generated from ./../../src/tl-set.lsp with <a href="http://www.xs4all.nl/~rfsber/Robo/robodoc.html">ROBODoc</a> V4.99.44 on 2025-02-13 09:01:45</p>
</div> <!-- footer -->
</body>
</html>
